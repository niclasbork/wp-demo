document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-demo-theme-demo-contact-form-block .demo-contact-form").forEach(e=>{const t=e.closest(".wp-block-demo-theme-demo-contact-form-block"),s=t.dataset.toEmail,o=t.dataset.successMessage,a=t.dataset.errorMessage,n=e.querySelector(".form-message");e.addEventListener("submit",async t=>{t.preventDefault(),n.textContent="",n.classList.remove("success","error");const c=new FormData(e),r={name:c.get("name"),email:c.get("email"),subject:c.get("subject"),message:c.get("message"),toEmail:s};if(!(r.name&&r.email&&r.subject&&r.message))return n.textContent="Please fill in all fields.",void n.classList.add("error");try{const t=await fetch(wpApiSettings.root+"demo-theme/v1/submit-contact-form",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce},body:JSON.stringify(r)}),s=await t.json();s.success?(n.textContent=o,n.classList.add("success"),e.reset()):(n.textContent=a+(s.message?` (${s.message})`:""),n.classList.add("error"))}catch(e){console.error("Error submitting form:",e),n.textContent=a+` (${e.message})`,n.classList.add("error")}})})});